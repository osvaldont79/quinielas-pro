<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quinielas-Pro ‚Ä¢ Jornada 17</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {font-family:Arial,sans-serif;background:linear-gradient(135deg,#0d1b2a,#1b263b,#415a77);color:#fff;margin:0;padding:15px;}
    .contenedor {max-width:850px;margin:0 auto;background:rgba(0,0,0,0.7);border-radius:20px;padding:30px;box-shadow:0 15px 50px rgba(0,0,0,0.9);}
    h1 {text-align:center;font-size:3.2em;color:#ffd700;text-shadow:0 0 15px gold;}
    .sub {text-align:center;font-size:1.6em;color:#ffeb3b;margin:15px 0 25px;}
    input,select {width:100%;padding:16px;margin:10px 0;border-radius:12px;border:none;font-size:18px;}
    .partido {background:#fff;color:#000;margin:18px 0;padding:20px;border-radius:18px;box-shadow:0 6px 20px rgba(0,0,0,0.5);}
    .partido label {font-weight:bold;font-size:1.4em;text-align:center;display:block;margin-bottom:15px;color:#1e3c72;}
    .botones {display:flex;justify-content:center;gap:30px;}
    .botones button {width:110px;height:85px;font-size:32px;font-weight:bold;border:none;border-radius:18px;cursor:pointer;}
    
    /* COLORES NUEVOS */
    .local {background:#2e7d32;color:white;}     /* Verde */
    .empate {background:#f57c00;color:white;}    /* Naranja */
    .visita {background:#1565c0;color:white;}   /* AZUL OSCURO (Visitante) */
    
    .seleccionado {transform:scale(1.25);box-shadow:0 0 30px gold;}
    .botones-flex {display:flex;gap:15px;margin-top:40px;}
    .btn-generar,.btn-guardar {flex:1;padding:20px;font-size:22px;font-weight:bold;border:none;border-radius:50px;cursor:pointer;}
    .btn-generar {background:#ffd700;color:#000;}
    .btn-guardar {background:#4caf50;color:white;}
    .ok {color:#4caf50;text-align:center;font-size:20px;margin-top:20px;font-weight:bold;}
    
    /* Panel admin OCULTO para los usuarios normales */
    #panel-admin {display:none;}
    
    /* Solo visible para admin con par√°metro secreto */
    body.admin-visible #panel-admin {
      display:block;
      background:#000;
      padding:20px;
      border-radius:15px;
      margin-top:40px;
    }
    
    #tabla-general {width:100%;border-collapse:collapse;margin-top:15px;}
    #tabla-general th,#tabla-general td {border:1px solid #ffd700;padding:8px;text-align:center;font-size:13px;}
    #tabla-general th {background:#ffd700;color:#000;}
    .pagado {background:#1b5e20;color:white;}
    .nopagado {background:#c62828;color:white;}
    .btn-exportar {background:#2196F3;color:white;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;margin:5px;}
    .btn-limpiar-admin {background:#c62828;color:white;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;margin:5px;}
    
    /* Enlace admin discreto */
    .enlace-admin {
      text-align:center;
      margin-top:20px;
      font-size:14px;
    }
    .enlace-admin a {
      color:#9c27b0;
      text-decoration:none;
      font-weight:bold;
      cursor:pointer;
    }
    .enlace-admin a:hover {
      text-decoration:underline;
    }
  </style>
</head>
<body>

<div class="contenedor">
  <h1>QUINIELAS-PRO</h1>
  <p class="sub">Jornada 17 ‚Ä¢ Apertura 2025</p>

  <input type="text" id="nombre" placeholder="Nombre completo">
  <input type="text" id="telefono" placeholder="WhatsApp">
  <select id="pago">
    <option value="">¬øYa depositaste los $300?</option>
    <option value="si">S√≠, ya pagu√©</option>
    <option value="no">No, pago esta semana</option>
  </select>

  <!-- 14 PARTIDOS -->
  <div class="partido"><label>1. Tigres vs Am√©rica</label><div class="botones"><button class="local" onclick="marcar(this,1)">L</button><button class="empate" onclick="marcar(this,1)">E</button><button class="visita" onclick="marcar(this,1)">V</button><input type="hidden" id="res1"></div></div>
  <div class="partido"><label>2. Cruz Azul vs Monterrey</label><div class="botones"><button class="local" onclick="marcar(this,2)">L</button><button class="empate" onclick="marcar(this,2)">E</button><button class="visita" onclick="marcar(this,2)">V</button><input type="hidden" id="res2"></div></div>
  <div class="partido"><label>3. Chivas vs Toluca</label><div class="botones"><button class="local" onclick="marcar(this,3)">L</button><button class="empate" onclick="marcar(this,3)">E</button><button class="visita" onclick="marcar(this,3)">V</button><input type="hidden" id="res3"></div></div>
  <div class="partido"><label>4. Pumas vs Pachuca</label><div class="botones"><button class="local" onclick="marcar(this,4)">L</button><button class="empate" onclick="marcar(this,4)">E</button><button class="visita" onclick="marcar(this,4)">V</button><input type="hidden" id="res4"></div></div>
  <div class="partido"><label>5. Atlas vs Le√≥n</label><div class="botones"><button class="local" onclick="marcar(this,5)">L</button><button class="empate" onclick="marcar(this,5)">E</button><button class="visita" onclick="marcar(this,5)">V</button><input type="hidden" id="res5"></div></div>
  <div class="partido"><label>6. Santos vs Tijuana</label><div class="botones"><button class="local" onclick="marcar(this,6)">L</button><button class="empate" onclick="marcar(this,6)">E</button><button class="visita" onclick="marcar(this,6)">V</button><input type="hidden" id="res6"></div></div>
  <div class="partido"><label>7. Necaxa vs Quer√©taro</label><div class="botones"><button class="local" onclick="marcar(this,7)">L</button><button class="empate" onclick="marcar(this,7)">E</button><button class="visita" onclick="marcar(this,7)">V</button><input type="hidden" id="res7"></div></div>
  <div class="partido"><label>8. Mazatl√°n vs Puebla</label><div class="botones"><button class="local" onclick="marcar(this,8)">L</button><button class="empate" onclick="marcar(this,8)">E</button><button class="visita" onclick="marcar(this,8)">V</button><input type="hidden" id="res8"></div></div>
  <div class="partido"><label>9. San Luis vs Ju√°rez</label><div class="botones"><button class="local" onclick="marcar(this,9)">L</button><button class="empate" onclick="marcar(this,9)">E</button><button class="visita" onclick="marcar(this,9)">V</button><input type="hidden" id="res9"></div></div>
  <div class="partido"><label>10. Necaxa vs Guadalajara</label><div class="botones"><button class="local" onclick="marcar(this,10)">L</button><button class="empate" onclick="marcar(this,10)">E</button><button class="visita" onclick="marcar(this,10)">V</button><input type="hidden" id="res10"></div></div>
  <div class="partido"><label>11. Le√≥n vs Cruz Azul</label><div class="botones"><button class="local" onclick="marcar(this,11)">L</button><button class="empate" onclick="marcar(this,11)">E</button><button class="visita" onclick="marcar(this,11)">V</button><input type="hidden" id="res11"></div></div>
  <div class="partido"><label>12. Monterrey vs Tigres</label><div class="botones"><button class="local" onclick="marcar(this,12)">L</button><button class="empate" onclick="marcar(this,12)">E</button><button class="visita" onclick="marcar(this,12)">V</button><input type="hidden" id="res12"></div></div>
  <div class="partido"><label>13. Am√©rica vs Pumas</label><div class="botones"><button class="local" onclick="marcar(this,13)">L</button><button class="empate" onclick="marcar(this,13)">E</button><button class="visita" onclick="marcar(this,13)">V</button><input type="hidden" id="res13"></div></div>
  <div class="partido"><label>14. Toluca vs Atlas</label><div class="botones"><button class="local" onclick="marcar(this,14)">L</button><button class="empate" onclick="marcar(this,14)">E</button><button class="visita" onclick="marcar(this,14)">V</button><input type="hidden" id="res14"></div></div>

  <div class="botones-flex">
    <button class="btn-generar" onclick="generarPDF()">DESCARGAR PDF</button>
    <button class="btn-guardar" onclick="guardarDatos()">GUARDAR DATOS</button>
  </div>

  <div class="ok" id="ok"></div>
  
  <!-- Enlace discreto para admin -->
  <div class="enlace-admin">
    <a onclick="mostrarPanelAdmin()">Acceso administrador</a>
  </div>
</div>

<!-- PANEL ADMIN (OCULTO para usuarios normales) -->
<div id="panel-admin">
  <h2 style="color:#ffd700;text-align:center;">PANEL ADMIN - TABLA GENERAL</h2>
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
    <div>
      <p style="margin:0;">Total: <span id="total">0</span> | Pagaron: <span id="pagados">0</span> | Pendientes: <span id="pendientes">0</span></p>
    </div>
    <div>
      <button class="btn-exportar" onclick="exportarExcel()">EXPORTAR EXCEL</button>
      <button class="btn-exportar" onclick="exportarPDFAdmin()">EXPORTAR PDF</button>
      <button class="btn-exportar" onclick="verGoogleSheets()">VER EN GOOGLE SHEETS</button>
      <button class="btn-limpiar-admin" onclick="ocultarPanelAdmin()">OCULTAR PANEL</button>
    </div>
  </div>
  <table id="tabla-general">
    <thead>
      <tr>
        <th>#</th><th>Nombre</th><th>Tel</th><th>Pago</th>
        <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th>
        <th>10</th><th>11</th><th>12</th><th>13</th><th>14</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
// ============ CONFIGURACI√ìN ============
// TU ID DE GOOGLE SHEETS (YA CONFIGURADO)
const GOOGLE_SHEETS_ID = '1wkEXNo60nsiSC9LC2iI6DcufL1tvTL4IpfBgRMksENU';
const GOOGLE_SHEETS_API_KEY = 'AIzaSyB2q3cK8yS6x6eL8vHxGzV9YQdHtJZ7vXs';

// Clave secreta para admin
const CLAVE_SECRETA = "admin2025";

// ============ FUNCIONES DE GOOGLE SHEETS ============

// Funci√≥n para guardar datos en Google Sheets
async function guardarEnGoogleSheets(datos) {
  try {
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEETS_ID}/values/A1:append?valueInputOption=RAW&key=${GOOGLE_SHEETS_API_KEY}`;
    
    const fila = [
      datos.nombre,
      datos.tel,
      datos.pago,
      ...datos.pronosticos,
      new Date().toLocaleString("es-MX")
    ];
    
    const response = await fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        values: [fila]
      })
    });
    
    const result = await response.json();
    console.log('Datos guardados:', result);
    return result;
  } catch (error) {
    console.error('Error guardando en Google Sheets:', error);
    throw error;
  }
}

// Funci√≥n para leer datos de Google Sheets
async function leerDeGoogleSheets() {
  try {
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${GOOGLE_SHEETS_ID}/values/A2:R?key=${GOOGLE_SHEETS_API_KEY}`;
    
    const response = await fetch(url);
    const data = await response.json();
    
    if (data.values && data.values.length > 0) {
      return data.values.map(fila => ({
        nombre: fila[0] || '',
        tel: fila[1] || '',
        pago: fila[2] || '',
        pronosticos: fila.slice(3, 17) || Array(14).fill('-'),
        fecha: fila[17] || ''
      }));
    }
    return [];
  } catch (error) {
    console.error('Error leyendo de Google Sheets:', error);
    return [];
  }
}

// ============ FUNCIONES PRINCIPALES ============

function marcar(btn, num) {
  const grupo = btn.parentNode.querySelectorAll("button");
  grupo.forEach(b => b.classList.remove("seleccionado"));
  btn.classList.add("seleccionado");
  document.getElementById("res" + num).value = btn.innerText;
}

async function guardarDatos() {
  const nombre = document.getElementById("nombre").value.trim();
  const tel = document.getElementById("telefono").value.trim();
  const pago = document.getElementById("pago").value;

  if (!nombre || !tel || !pago) {
    alert("Por favor, llena todos los datos: nombre, WhatsApp y estado de pago");
    return;
  }

  const pronos = [];
  let faltan = false;
  for (let i=1; i<=14; i++) {
    const v = document.getElementById("res"+i).value;
    if (!v) faltan = true;
    pronos.push(v || "-");
  }
  
  if (faltan) {
    if (!confirm("Faltan algunos pron√≥sticos. ¬øDeseas guardar de todos modos? (Los partidos sin seleccionar se guardar√°n como '-')")) {
      return;
    }
  }

  // Datos a guardar
  const datos = {
    nombre, 
    tel, 
    pago, 
    pronosticos: pronos
  };

  try {
    document.getElementById("ok").innerHTML = "‚åõ Guardando datos en la nube...";
    document.getElementById("ok").style.color = "#ffd700";
    
    // Guardar en Google Sheets
    await guardarEnGoogleSheets(datos);
    
    document.getElementById("ok").innerHTML = "‚úÖ ¬°Datos guardados CORRECTAMENTE en Google Sheets!";
    document.getElementById("ok").style.color = "#4caf50";
    
    // Si el panel admin est√° visible, actualizar
    if (document.body.classList.contains('admin-visible')) {
      await actualizarTabla();
    }
    
    // Limpiar formulario despu√©s de guardar
    setTimeout(() => {
      limpiarFormulario();
    }, 2000);
    
  } catch (error) {
    document.getElementById("ok").innerHTML = "‚ùå Error al guardar. Intenta de nuevo.";
    document.getElementById("ok").style.color = "#f44336";
    console.error('Error guardando:', error);
    
    // Intentar guardar localmente como respaldo
    try {
      let participantesLocal = JSON.parse(localStorage.getItem("quinielasBackup") || "[]");
      participantesLocal.push({...datos, fecha: new Date().toLocaleString("es-MX")});
      localStorage.setItem("quinielasBackup", JSON.stringify(participantesLocal));
      document.getElementById("ok").innerHTML += " (Datos guardados localmente como respaldo)";
    } catch (e) {
      console.error('Error guardando respaldo:', e);
    }
  }
}

function generarPDF() {
  const nombre = document.getElementById("nombre").value.trim();
  const tel = document.getElementById("telefono").value.trim();
  const pago = document.getElementById("pago").value;

  if (!nombre || !tel || !pago) {
    alert("Por favor, llena todos los datos antes de generar el PDF");
    return;
  }

  const pronos = [];
  let faltan = false;
  for (let i=1; i<=14; i++) {
    const v = document.getElementById("res"+i).value;
    if (!v) faltan = true;
    pronos.push(v || "-");
  }
  
  if (faltan) {
    if (!confirm("Faltan algunos pron√≥sticos. ¬øDeseas generar el PDF de todos modos? (Los partidos sin seleccionar aparecer√°n como '-')")) {
      return;
    }
  }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('p', 'mm', 'a4');

  // FORMATO ESPEC√çFICO PARA QUE EL ADMIN PUEDA LEERLO F√ÅCILMENTE
  
  // T√≠tulo principal - usando el formato exacto que busca el admin
  doc.setFontSize(28);
  doc.setTextColor(255, 215, 0);
  doc.text("QUINIELAS-PRO - JORNADA", 105, 20, {align: "center"});
  
  // Nombre - en el formato exacto "Nombre: [nombre]"
  doc.setFontSize(16);
  doc.setTextColor(0, 0, 0);
  doc.text("Nombre: " + nombre, 20, 35);
  
  // WhatsApp - en el formato exacto "WhatsApp: [n√∫mero]"
  doc.text("WhatsApp: " + tel, 20, 45);
  
  // Pago - usando el texto exacto que busca el admin
  doc.text("Pago: " + (pago === "si" ? "PAGADO" : "PENDIENTE"), 20, 55);
  
  // Fecha - en el formato que aparece en el PDF original
  doc.text("Fecha: " + new Date().toLocaleString("es-MX", {
    day: 'numeric',
    month: 'numeric',
    year: 'numeric',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit'
  }), 20, 65);
  
  // LISTA DE PARTIDOS CON EL FORMATO ESPEC√çFICO
  doc.setFontSize(12);
  let y = 80;
  
  const partidos = [
    "1 . T i g r e s   v s   A m √© r i c a",
    "2 . C r u z   A z u l   v s   M o n t e r r e y",
    "3 . C h i v a s   v s   T o l u c a",
    "4 . P u m a s   v s   P a c h u c a",
    "5 . A t l a s   v s   L e √≥ n",
    "6 . S a n t o s   v s   T i j u a n a",
    "7 . N e c a x a   v s   Q u e r √© t a r o",
    "8 . M a z a t l √° n   v s   P u e b l a",
    "9 . S a n   L u i s   v s   J u √° r e z",
    "10 . N e c a x a   v s   G u a d a l a j a r a",
    "11 . L e √≥ n   v s   C r u z   A z u l",
    "12 . M o n t e r r e y   v s   T i g r e s",
    "13 . A m √© r i c a   v s   P u m a s",
    "14 . T o l u c a   v s   A t l a s"
  ];
  
  // Agregar cada partido con el pron√≥stico en el formato exacto
  for (let i = 0; i < partidos.length; i++) {
    const pronostico = pronos[i];
    
    // Formato exacto: "1 . T i g r e s   v s   A m √© r i c a !' L"
    const textoLinea = partidos[i] + "   !'   " + pronostico;
    doc.text(textoLinea, 20, y);
    
    y += 10;
    
    // Si nos quedamos sin espacio, agregar nueva p√°gina
    if (y > 270 && i < partidos.length - 1) {
      doc.addPage();
      y = 20;
    }
  }
  
  // Nombre del archivo usando el nombre del participante
  doc.save(nombre.replace(/[^a-zA-Z0-9]/g, "_") + "_J17.pdf");
  document.getElementById("ok").innerHTML = "üìÑ PDF generado y descargado";
  document.getElementById("ok").style.color = "#ffd700";
}

function limpiarFormulario() {
  document.getElementById("nombre").value = "";
  document.getElementById("telefono").value = "";
  document.getElementById("pago").value = "";
  for (let i=1; i<=14; i++) {
    document.getElementById("res"+i).value = "";
    const grupo = document.querySelector(`#res${i}`).parentNode.querySelectorAll("button");
    grupo.forEach(b => b.classList.remove("seleccionado"));
  }
  document.getElementById("ok").innerHTML = "";
}

// ============ FUNCIONES ADMIN ============

function verificarParametroSecreto() {
  const urlParams = new URLSearchParams(window.location.search);
  const clave = urlParams.get('clave');
  
  if (clave === CLAVE_SECRETA) {
    document.body.classList.add('admin-visible');
    actualizarTabla();
  }
}

async function mostrarPanelAdmin() {
  const claveIngresada = prompt("Ingresa la clave de administrador:");
  
  if (claveIngresada === CLAVE_SECRETA) {
    document.body.classList.add('admin-visible');
    await actualizarTabla();
    // Agregar clave a la URL
    const nuevaURL = window.location.origin + window.location.pathname + '?clave=' + CLAVE_SECRETA;
    window.history.pushState({}, '', nuevaURL);
    // Desplazar al panel admin
    document.getElementById("panel-admin").scrollIntoView({behavior: 'smooth'});
  } else {
    alert("Clave incorrecta");
  }
}

function ocultarPanelAdmin() {
  document.body.classList.remove('admin-visible');
  window.history.pushState({}, '', window.location.pathname);
}

// Cargar al iniciar
document.addEventListener('DOMContentLoaded', function() {
  verificarParametroSecreto();
});

async function actualizarTabla() {
  const okElement = document.getElementById("ok");
  okElement.innerHTML = "üîÑ Cargando datos de Google Sheets...";
  okElement.style.color = "#ffd700";
  
  try {
    const participantes = await leerDeGoogleSheets();
    
    const tbody = document.querySelector("#tabla-general tbody");
    tbody.innerHTML = "";
    
    if (participantes.length === 0) {
      tbody.innerHTML = `<tr><td colspan="20" style="text-align:center;padding:20px;">No hay datos a√∫n. Los participantes aparecer√°n aqu√≠ cuando guarden sus pron√≥sticos.</td></tr>`;
    } else {
      participantes.forEach((p,i) => {
        let row = `<tr>
          <td>${i+1}</td>
          <td>${p.nombre}</td>
          <td>${p.tel}</td>
          <td class="${p.pago==='si'?'pagado':'nopagado'}">${p.pago==='si'?'PAGADO':'NO PAG√ì'}</td>`;
        
        // Mostrar los 14 pron√≥sticos
        for (let j = 0; j < 14; j++) {
          const pron = p.pronosticos && p.pronosticos[j] ? p.pronosticos[j] : '-';
          row += `<td><strong>${pron}</strong></td>`;
        }
        
        row += `<td>${p.fecha}</td></tr>`;
        tbody.innerHTML += row;
      });
    }
    
    const total = participantes.length;
    const pagados = participantes.filter(p => p.pago === "si").length;
    const pendientes = total - pagados;
    
    document.getElementById("total").textContent = total;
    document.getElementById("pagados").textContent = pagados;
    document.getElementById("pendientes").textContent = pendientes;
    
    okElement.innerHTML = `‚úÖ Datos cargados: ${total} participantes`;
    okElement.style.color = "#4caf50";
    
  } catch (error) {
    okElement.innerHTML = "‚ùå Error cargando datos. Verifica tu conexi√≥n.";
    okElement.style.color = "#f44336";
    console.error('Error actualizando tabla:', error);
  }
}

function exportarExcel() {
  // Abrir Google Sheets directamente
  window.open(`https://docs.google.com/spreadsheets/d/${GOOGLE_SHEETS_ID}/export?format=xlsx`, '_blank');
}

function verGoogleSheets() {
  // Abrir Google Sheets en una nueva pesta√±a
  window.open(`https://docs.google.com/spreadsheets/d/${GOOGLE_SHEETS_ID}/edit`, '_blank');
}

function exportarPDFAdmin() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('l', 'mm', 'a4');
  
  doc.setFontSize(16);
  doc.text("TABLA GENERAL - QUINIELAS PRO - JORNADA 17", 150, 15, {align: "center"});
  doc.text("Google Sheets ID: " + GOOGLE_SHEETS_ID, 150, 22, {align: "center"});
  doc.setFontSize(10);
  
  // Leer datos y generar PDF
  leerDeGoogleSheets().then(participantes => {
    if (participantes.length === 0) {
      doc.text("No hay datos disponibles", 150, 40, {align: "center"});
      doc.save("tabla_general_quinielas_vacia.pdf");
      return;
    }
    
    const headers = ["#", "Nombre", "Tel", "Pago", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "Fecha"];
    let x = 10;
    
    headers.forEach((header, i) => {
      doc.text(header, x, 35);
      x += i === 1 ? 40 : i === 2 ? 20 : i === 18 ? 30 : 10;
    });
    
    doc.line(10, 38, 287, 38);
    
    let y = 45;
    participantes.forEach((p, i) => {
      if (y > 190) {
        doc.addPage();
        y = 20;
        x = 10;
        headers.forEach((header, idx) => {
          doc.text(header, x, y+5);
          x += idx === 1 ? 40 : idx === 2 ? 20 : idx === 18 ? 30 : 10;
        });
        doc.line(10, y+8, 287, y+8);
        y += 15;
      }
      
      x = 10;
      doc.text((i+1).toString(), x, y);
      x += 10;
      doc.text(p.nombre.substring(0, 20), x, y);
      x += 40;
      doc.text(p.tel, x, y);
      x += 20;
      doc.text(p.pago === 'si' ? 'PAGADO' : 'NO PAG√ì', x, y);
      x += 10;
      
      // Mostrar los 14 pron√≥sticos
      for (let j = 0; j < 14; j++) {
        const pron = p.pronosticos && p.pronosticos[j] ? p.pronosticos[j] : '-';
        doc.text(pron, x, y);
        x += 10;
      }
      
      doc.text(p.fecha.substring(0, 16), x, y);
      
      y += 8;
    });
    
    doc.save("tabla_general_quinielas_" + new Date().toISOString().slice(0,10) + ".pdf");
  }).catch(error => {
    console.error('Error generando PDF:', error);
    alert("Error al generar PDF. Verifica tu conexi√≥n.");
  });
}

// Funci√≥n para recargar datos manualmente
function recargarDatos() {
  actualizarTabla();
}
</script>
</body>
</html>